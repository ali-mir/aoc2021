this is a work in progress and the code isn't particularly clean
