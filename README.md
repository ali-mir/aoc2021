this is a work in progress and the code isn't particularly clean. if you have any cleanup suggestions, let me know.